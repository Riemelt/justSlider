(()=>{"use strict";function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,r=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return r}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const i=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventManager=e}var i,a;return i=t,a=[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.from,n=void 0===t?0:t,i=e.to,a=void 0===i?100:i,r=e.min,o=void 0===r?0:r,s=e.max,l=void 0===s?100:s,d=e.step,u=void 0===d?10:d,c=e.orientation,v=void 0===c?"horizontal":c,h=e.direction,p=void 0===h?"forward":h,f=e.range,m=void 0!==f&&f,y=e.tooltips,g=void 0!==y&&y,b=e.progressBar,k=void 0!==b&&b,S=e.scale,H=void 0===S?null:S,w=e.precision,M=void 0===w?0:w;this.state={from:n,to:a,range:m,min:o,max:l,step:u,orientation:v,direction:p,tooltips:g,progressBar:k,precision:M},this.setMinMax(o,l),this.setStep(u),this.setHandle(n,"from"),this.setHandle(a,"to"),this.setScale(H)}},{key:"getState",value:function(){return this.state}},{key:"updateOptions",value:function(e){var t=this,n=e.from,i=e.to,a=e.min,r=e.max,o=e.step,s=e.orientation,l=e.direction,d=e.range,u=e.tooltips,c=e.progressBar,v=e.scale,h=e.precision,p=!1,f=new Set,m=new Set;if(void 0===a&&void 0===r||(this.setMinMax(a,r),this.setStep(this.state.step),p=!0,f.add("from").add("to"),m.add("HandleFromMove").add("HandleToMove").add("ProgressBarUpdate").add("ScaleUpdate").add("SliderUpdate")),void 0!==o&&(this.setStep(o),p=!0,f.add("from").add("to"),m.add("HandleFromMove").add("HandleToMove").add("ProgressBarUpdate").add("ScaleUpdate").add("SliderUpdate")),void 0!==d&&(this.state.range=d,f.add("to"),m.add("HandleToMove").add("ProgressBarUpdate").add("SliderUpdate")),void 0!==l&&(this.state.direction=l,m.add("HandleFromMove").add("HandleToMove").add("ProgressBarUpdate").add("ScaleUpdate").add("SliderUpdate")),void 0!==s&&(this.state.orientation=s,m.add("OrientationUpdate").add("HandleFromMove").add("HandleToMove").add("ProgressBarUpdate").add("ScaleUpdate").add("SliderUpdate")),void 0!==c&&(this.state.progressBar=c,m.add("ProgressBarUpdate").add("SliderUpdate")),void 0!==u&&(this.state.tooltips=u,m.add("TooltipsUpdate").add("SliderUpdate")),void 0!==i&&(f.add("to"),m.add("HandleToMove").add("ProgressBarUpdate").add("SliderUpdate")),void 0!==n&&(f.add("from"),m.add("HandleFromMove").add("ProgressBarUpdate").add("SliderUpdate")),void 0!==v&&(p=!0,m.add("ScaleUpdate").add("SliderUpdate")),void 0!==h&&(h<=0&&(h=0),this.state.precision=h,p=!0,m.add("TooltipsUpdate").add("ScaleUpdate").add("SliderUpdate")),f.forEach((function(e){var a;a="from"===e?void 0!==n?n:t.state.from:void 0!==i?i:t.state.to,t.setHandle(a,e)})),p){var y=void 0===v?this.state.scale:v;this.setScale(y)}this.eventManager.dispatchEvents(Array.from(m))}},{key:"updateHandle",value:function(e,t){this.setHandle(e,t);var n="from"===t?"HandleFromMove":"HandleToMove";this.eventManager.dispatchEvents([n,"ProgressBarUpdate","SliderUpdate"])}},{key:"setScale",value:function(e){if(null!==e){var t=this.state.scale,n=e.type,i=void 0===n?null!=t&&t.type?t.type:"steps":n,a=e.set,r=void 0===a?null!=t&&t.set?t.set:[0,25,50,75,100]:a,o=e.density,s=void 0===o?null!=t&&t.density?t.density:3:o,l=e.lines,d=void 0===l?null==t||!t.lines||t.lines:l,u=e.numbers,c=void 0===u?null==t||!t.numbers||t.numbers:u;this.state.scale={set:r,type:i,lines:d,numbers:c,segments:[]},this.setScaleDensity(s),this.setScaleSet(r),("steps"===i?this.generateScaleSegmentsStepsMode.bind(this):this.generateScaleSegmentsSetMode.bind(this))()}else this.state.scale=null}},{key:"generateScaleSegmentsStepsMode",value:function(){for(var e=this.state.scale.density,t=this.state,n=t.min,i=t.max,a=t.step,r=(i-n)*e/100,o=n;o<i;o+=a){var s={value:o,type:"number"};this.state.scale.segments.push(s);var l=(o+a>=i?i:o+a)-o,d=void 0;0===r?d=0:(d=Math.trunc(l/r),d+=l%r==0?-1:0);for(var u=l/(d+1),c=0;c<d;c++){var v={value:o+(c+1)*u,type:"line"};this.state.scale.segments.push(v)}}this.state.scale.segments.push({value:i,type:"number"})}},{key:"generateScaleSegmentsSetMode",value:function(){for(var e=this.state.scale,t=e.density,n=e.set,i=this.state,a=i.min,r=i.max,o=0;o<n.length-1;o++){var s={value:this.getValueFromPercentage(n[o],a,r),type:"number"};this.state.scale.segments.push(s);var l=n[o+1]-n[o],d=void 0;0===t?d=0:(d=Math.trunc(l/t),d+=l%t==0?-1:0);for(var u=l/(d+1),c=0;c<d;c++){var v=n[o]+(c+1)*u,h={value:this.getValueFromPercentage(v,a,r),type:"line"};this.state.scale.segments.push(h)}}this.state.scale.segments.push({value:r,type:"number"})}},{key:"getValueFromPercentage",value:function(e,t,n){return t+(n-t)*e/100}},{key:"setScaleSet",value:function(e){var t=this.validateScaleSet(e);t.sort((function(e,t){return e-t})),t.push(100),t.unshift(0);var n=Array.from(new Set(t));this.state.scale.set=n}},{key:"validateScaleSet",value:function(e){return e.filter((function(e){return e>=0&&e<=100}))}},{key:"setScaleDensity",value:function(e){var t=this.validateScaleDensity(e);this.state.scale.density=t}},{key:"validateScaleDensity",value:function(e){return e<0?0:e>100?100:e}},{key:"setHandle",value:function(e,t){var n=this.state.step,i=this.adjustHandle(e,n,t),a=this.validateHandle(e,t);this.state[t]=e!==a?a:i}},{key:"adjustHandle",value:function(e,t,n){var i=this.state.min,a=e+-1*i,r=Math.round(a/t)*t+i;return this.validateHandle(r,n)}},{key:"validateHandle",value:function(e,t){var n=this.state,i=n.to,a=n.max,r=n.min,o=n.from,s=n.range;return e=this.validateHandleOnCollision(e,t,o,i,s),this.validateHandleOnMinMax(e,r,a)}},{key:"validateHandleOnMinMax",value:function(e,t,n){return e>n&&(e=n),e<t&&(e=t),e}},{key:"validateHandleOnCollision",value:function(e,t,n,i,a){return a?e="from"===t?e>i?i:e:e<n?n:e:e}},{key:"validateMinMax",value:function(t,n){var i,a;return t=(a=e(i=t>n?[n,t]:[t,n],2))[0],n=a[1],i}},{key:"setMinMax",value:function(t,n){var i=void 0!==t?t:this.state.min,a=void 0!==n?n:this.state.max,r=e(this.validateMinMax(i,a),2);this.state.min=r[0],this.state.max=r[1]}},{key:"validateStep",value:function(e,t){var n=e>t?t:e;return n<=0?1:n}},{key:"setStep",value:function(e){this.state.step=this.validateStep(e,this.state.max-this.state.min)}}],a&&n(i.prototype,a),Object.defineProperty(i,"prototype",{writable:!1}),t}();var a=["onUpdate"];function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const o=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.view=t,this.model=n,this.eventManager=i}var t,n;return t=e,(n=[{key:"init",value:function(e){var t=e.onUpdate,n=function(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,a);this.model.init(n);var i=this.model.getState();this.view.init(i),this.onUpdate=t,this.createHandlers(),this.registerEvents(),this.addEventListeners(),this.view.initComponents(),this.eventManager.dispatchEvents(["HandleFromMove","HandleToMove","ProgressBarUpdate","OrientationUpdate","TooltipsUpdate","ScaleUpdate","SliderClickEnable","SliderUpdate"])}},{key:"$getSlider",value:function(){return this.view.getHtml()}},{key:"updateHandle",value:function(e,t){this.model.updateHandle(t,e)}},{key:"updateOptions",value:function(e){this.model.updateOptions(e)}},{key:"createHandlers",value:function(){var e=this;this.view.addCreateHandleHandlers((function(t,n){e.model.updateHandle(t,n)})),this.view.addCreateSliderClickHandler((function(t,n){e.model.updateHandle(t,n)})),this.view.addCreateScaleClickHandler((function(t,n){e.model.updateHandle(t,n)}))}},{key:"registerEvents",value:function(){this.eventManager.registerEvent("HandleFromMove"),this.eventManager.registerEvent("HandleToMove"),this.eventManager.registerEvent("SliderUpdate"),this.eventManager.registerEvent("OrientationUpdate"),this.eventManager.registerEvent("TooltipsUpdate"),this.eventManager.registerEvent("ProgressBarUpdate"),this.eventManager.registerEvent("ScaleUpdate"),this.eventManager.registerEvent("SliderClickDisable"),this.eventManager.registerEvent("SliderClickEnable")}},{key:"addEventListeners",value:function(){var e=this;this.eventManager.addEventListener("HandleFromMove",(function(){var t=e.model.getState();e.view.updateHandleFrom(t)})),this.eventManager.addEventListener("HandleToMove",(function(){var t=e.model.getState();e.view.updateHandleTo(t)})),this.eventManager.addEventListener("ProgressBarUpdate",(function(){var t=e.model.getState();e.view.updateProgressBar(t)})),this.eventManager.addEventListener("OrientationUpdate",(function(){var t=e.model.getState();e.view.setOrientation(t.orientation)})),this.eventManager.addEventListener("TooltipsUpdate",(function(){var t=e.model.getState();e.view.updateTooltips(t)})),this.eventManager.addEventListener("ScaleUpdate",(function(){var t=e.model.getState();e.view.updateScale(t)})),this.eventManager.addEventListener("SliderClickDisable",(function(){e.view.removeSliderClickHandler()})),this.eventManager.addEventListener("SliderClickEnable",(function(){e.view.setSliderClickHandler()})),this.eventManager.addEventListener("SliderUpdate",(function(){var t,n=e.model.getState();null===(t=e.onUpdate)||void 0===t||t.call(e,n)}))}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function s(e){var t=e.shift,n=e.min,i=e.max,a=e.orientation,r=e.direction,o=e.scale,s=function(e){return"horizontal"===e?"X":"Y"}(a),d=function(e,t,n,i,a){var r="horizontal"===i?-1:1,o=l(e,t,n);return"forward"===a?(100-o)*r:o*r}(t,n,i,a,r),u=function(e,t){return"translate".concat(t,"(").concat(e,"%)")}(d,s),c=u;if(void 0!==o){var v=function(e,t){return"scale".concat(t,"(").concat(e,")")}(o,s);c+=" ".concat(v)}return{property:"transform",style:c}}function l(e,t,n){return Math.abs((e-t)/(n-t)*100)}function d(e,t){return e.toFixed(t)}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init(t)}var t,n;return t=e,(n=[{key:"update",value:function(e,t){var n=d(e,t);this.$component.html(n)}},{key:"delete",value:function(){this.$component.remove()}},{key:"init",value:function(e){this.initHtml(),e.append(this.$component)}},{key:"initHtml",value:function(){this.$component=$('\n      <div class="just-slider__tooltip">\n      </div>\n  ')}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventManager=t.eventManager,this.init(t)}var t,n;return t=e,(n=[{key:"getHandleHTML",value:function(){return this.$handle}},{key:"setHandleMousemoveHandler",value:function(e){this.handleHandleMousemove=e}},{key:"delete",value:function(){this.deleteHandlers(),this.$point.remove()}},{key:"update",value:function(e){this.state=e;var t=e[this.type],n=e.min,i=e.max,a=e.orientation,r=e.direction;this.updatePosition({min:n,max:i,orientation:a,direction:r,shift:t}),this.updateFocus(t,n,i,this.type),this.updateTooltip(e)}},{key:"updateTooltip",value:function(e){var t=e.tooltips,n=e.precision,i=e[this.type];if(t)return this.tooltip||(this.tooltip=new c(this.$handle)),void this.tooltip.update(i,n);this.tooltip&&this.deleteTooltip()}},{key:"deleteTooltip",value:function(){var e;null===(e=this.tooltip)||void 0===e||e.delete(),delete this.tooltip}},{key:"updateFocus",value:function(e,t,n,i){"to"===i&&(e<(n-t)/2+t?(this.$point.addClass("just-slider__point_focused"),this.$point.removeClass("just-slider__point_unfocused")):(this.$point.removeClass("just-slider__point_focused"),this.$point.addClass("just-slider__point_unfocused")))}},{key:"updatePosition",value:function(e){var t=s(e),n=t.property,i=t.style;this.$point.css(n,i)}},{key:"init",value:function(e){var t=e.$parent,n=e.type;this.type=n,this.initHtml(),this.$handle=this.$point.find(".just-slider__handle"),this.setHandlers(),t.append(this.$point)}},{key:"initHtml",value:function(){this.$point=$('\n      <div class="just-slider__point">\n        <div class="just-slider__handle">\n        </div>\n      </div>\n    ')}},{key:"setHandlers",value:function(){this.$handle.on("pointerdown.handle",this.handleMousedown.bind(this))}},{key:"deleteHandlers",value:function(){this.$handle.off("pointerdown.handle")}},{key:"handleMousedown",value:function(e){e.preventDefault(),this.eventManager.dispatchEvent("SliderClickDisable");var t=("horizontal"===this.state.orientation?this.$handle.offset().left:this.$handle.offset().top)+("horizontal"===this.state.orientation?this.$handle.outerWidth():this.$handle.outerHeight())/2;this.shiftFromCenter="horizontal"===this.state.orientation?e.pageX-t:e.pageY-t,$(document).on("pointermove.handle",this.handleDocumentMousemove.bind(this)),$(document).on("pointerup.handle",this.handleDocumentMouseup.bind(this))}},{key:"handleDocumentMousemove",value:function(e){var t,n="horizontal"===this.state.orientation?e.pageX-this.shiftFromCenter:e.pageY-this.shiftFromCenter;null===(t=this.handleHandleMousemove)||void 0===t||t.call(this,n,this.type)}},{key:"handleDocumentMouseup",value:function(){$(document).off("pointerup.handle"),$(document).off("pointermove.handle"),this.eventManager.dispatchEvent("SliderClickEnable")}}])&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init(t)}var t,n;return t=e,(n=[{key:"update",value:function(e){var t=e.min,n=e.max,i=e.from,a=e.to,r=e.range,o=e.orientation,s=e.direction,l=r?i:t,d=r?a:i,u="forward"===s?d:l,c=(d-l)/(n-t);this.updatePosition({min:t,max:n,orientation:o,direction:s,shift:u,scale:c})}},{key:"delete",value:function(){this.$component.remove()}},{key:"updatePosition",value:function(e){var t=s(e),n=t.property,i=t.style;this.$bar.css(n,i)}},{key:"init",value:function(e){this.initHtml(),e.append(this.$component)}},{key:"initHtml",value:function(){this.$component=$('\n      <div class="just-slider__progress-bar-wrapper">\n        <div class="just-slider__progress-bar">\n        </div>\n      </div>\n    '),this.$bar=this.$component.find(".just-slider__progress-bar")}}])&&p(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const k=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),b(this,"numberClass","just-slider__scale-number"),b(this,"lineClass","just-slider__scale-line"),this.init(t)}var t,n;return t=e,n=[{key:"setNumberClickHandler",value:function(e){this.handleNumberClick=e}},{key:"delete",value:function(){this.$component.find(".".concat(this.numberClass)).off("click.scale"),this.$component.remove()}},{key:"update",value:function(e){var t=this;this.$component.empty();var n=e.min,i=e.max,a=e.orientation,r=e.direction,o=e.precision,s=e.scale,l=s.segments,d=s.numbers,u=s.lines;this.setStyleModificator(u),l.forEach((function(e,s){var c=e.type,v=e.value,h={min:n,max:i,direction:r,orientation:a,shift:v},p=t.isFirstOrLast(s,l.length);if("line"!==c){if(u){var f=p?"large":"big",m=t.createLineSegment(f);t.updatePosition(y(y({},h),{},{$element:m}))}if(d){var g=t.createNumberSegment(v,p,o);t.updatePosition(y(y({},h),{},{$element:g}))}}else if(u){var b=t.createLineSegment();t.updatePosition(y(y({},h),{},{$element:b}))}}))}},{key:"updatePosition",value:function(e){var t=e.$element,n=function(e){var t=e.shift,n=e.min,i=e.max,a=e.orientation,r=function(e,t,n,i){var a=l(e,t,n);return"backward"===i?100-a:a}(t,n,i,e.direction);return{property:"horizontal"===a?"left":"bottom",style:"".concat(r,"%")}}({shift:e.shift,min:e.min,max:e.max,direction:e.direction,orientation:e.orientation}),i=n.property,a=n.style;t.css(i,a)}},{key:"isFirstOrLast",value:function(e,t){return 0===e||e===t-1}},{key:"setStyleModificator",value:function(e){e?this.$component.removeClass("just-slider__scale_without-lines"):this.$component.addClass("just-slider__scale_without-lines")}},{key:"createNumberSegment",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,a=d(e,i),r=$('<div class="'.concat(this.numberClass,'">').concat(a,"</div>"));return r.on("click.scale",(function(){return t.handleNumberClick(e)})),n&&r.addClass("just-slider__scale-number_big"),this.$component.append(r),r}},{key:"createLineSegment",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",t=$('<div class="'.concat(this.lineClass,'"></div>'));return"big"===e&&t.addClass("just-slider__scale-line_big"),"large"===e&&t.addClass("just-slider__scale-line_large"),this.$component.append(t),t}},{key:"init",value:function(e){this.initHtml(),e.append(this.$component)}},{key:"initHtml",value:function(){this.$component=$('<div class="just-slider__scale"></div>')}}],n&&g(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function S(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const H=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventManager=t}var t,n;return t=e,(n=[{key:"getHtml",value:function(){return this.$html}},{key:"init",value:function(e){this.state=e,this.handles={from:void 0,to:void 0},this.initHtml()}},{key:"setOrientation",value:function(e){"vertical"!==e?this.$html.removeClass("just-slider_vertical"):this.$html.addClass("just-slider_vertical")}},{key:"initComponents",value:function(){this.initHandle("from")}},{key:"updateHandleFrom",value:function(e){this.handles.from.update(e)}},{key:"updateHandleTo",value:function(e){if(e.range)return this.handles.to||this.initHandle("to"),void this.handles.to.update(e);this.handles.to&&this.deleteHandle("to")}},{key:"deleteHandle",value:function(e){var t;null===(t=this.handles[e])||void 0===t||t.delete(),delete this.handles[e]}},{key:"addCreateHandleHandlers",value:function(e){var t=this;this.handleHandleMousemove=function(n,i){var a=t.getConvertedPosition(n);e(a,i)}}},{key:"updateTooltips",value:function(e){var t,n;null===(t=this.handles.from)||void 0===t||t.updateTooltip(e),null===(n=this.handles.to)||void 0===n||n.updateTooltip(e)}},{key:"updateProgressBar",value:function(e){if(e.progressBar)return this.progressBar||(this.progressBar=new f(this.$justSlider)),void this.progressBar.update(e);this.progressBar&&this.deleteProgressBar()}},{key:"deleteProgressBar",value:function(){var e;null===(e=this.progressBar)||void 0===e||e.delete(),delete this.progressBar}},{key:"updateScale",value:function(e){var t;e.scale?(this.scale||(this.scale=new k(this.$html),this.scale.setNumberClickHandler(null===(t=this.scaleClickHandler)||void 0===t?void 0:t.bind(this))),this.scale.update(e)):this.scale&&this.deleteScale()}},{key:"deleteScale",value:function(){var e;null===(e=this.scale)||void 0===e||e.delete(),delete this.scale}},{key:"addCreateScaleClickHandler",value:function(e){var t=this;this.scaleClickHandler=function(n){var i=t.getClosestHandle(n);e(n,i)}}},{key:"addCreateSliderClickHandler",value:function(e){this.sliderClickHandler=e}},{key:"setSliderClickHandler",value:function(){this.$html.addClass("just-slider_animated"),this.$justSlider.on("pointerdown.slider",this.handleSliderClick.bind(this))}},{key:"removeSliderClickHandler",value:function(){this.$html.removeClass("just-slider_animated"),this.$justSlider.off("pointerdown.slider")}},{key:"initHandle",value:function(e){this.handles[e]=new h({type:e,$parent:this.$justSlider,eventManager:this.eventManager}),this.handles[e].setHandleMousemoveHandler(this.handleHandleMousemove.bind(this))}},{key:"handleSliderClick",value:function(e){var t="horizontal"===this.state.orientation?e.pageX:e.pageY,n=this.getConvertedPosition(t),i=this.getClosestHandle(n);this.sliderClickHandler(n,i)}},{key:"getClosestHandle",value:function(e){var t=this.state,n=t.from,i=t.to,a=t.range;return Math.abs(i-e)>Math.abs(n-e)||!a?"from":"to"}},{key:"getConvertedPosition",value:function(e){var t=this.state,n=t.min,i=t.max,a=t.orientation,r=function(e){var t=e.min,n=e.max,i=e.orientation,a=e.direction,r=(n-t)/e.length*(e.position-e.shift)+t;return"forward"===a&&"horizontal"===i||"backward"===a&&"vertical"===i?r:t+n-r}({position:e,min:n,max:i,orientation:a,direction:t.direction,length:"horizontal"===a?this.$justSlider.width():this.$justSlider.height(),shift:"horizontal"===a?this.$justSlider.offset().left:this.$justSlider.offset().top});return r}},{key:"initHtml",value:function(){this.$html=$('\n      <div class="just-slider">\n        <div class="just-slider__main">\n        </div>\n      </div>\n    '),this.$justSlider=this.$html.find(".just-slider__main")}}])&&S(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function w(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const M=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.presenter=n;var i=this.presenter.$getSlider();t.append(i)}var t,n;return t=e,(n=[{key:"updateHandle",value:function(e,t){this.presenter.updateHandle(e,t)}},{key:"updateOptions",value:function(e){this.presenter.updateOptions(e)}}])&&w(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function j(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observers=[]}var t,n;return t=e,(n=[{key:"subscribe",value:function(e){this.observers.push(e)}},{key:"unsubscribe",value:function(e){this.observers=this.observers.filter((function(t){return t!==e}))}}])&&j(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function O(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const P=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventsSubjects={}}var t,n;return t=e,(n=[{key:"getEventSubjects",value:function(){return this.eventsSubjects}},{key:"registerEvent",value:function(e){this.eventsSubjects[e]=new C}},{key:"dispatchEvent",value:function(e){var t;null===(t=this.eventsSubjects[e])||void 0===t||t.observers.forEach((function(e){return e()}))}},{key:"dispatchEvents",value:function(e){var t=this;e.forEach((function(e){t.dispatchEvent(e)}))}},{key:"addEventListener",value:function(e,t){this.eventsSubjects[e].subscribe(t)}}])&&O(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();jQuery.fn.extend({justSlider:function(e){var t=new P,n=new i(t),a=new H(t),r=new o(a,n,t);return r.init(e),new M(this,r)}})})();